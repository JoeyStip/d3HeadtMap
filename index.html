<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Global Heat</title>
        <link href="index.css" rel="stylesheet">
    </head>
    <body>
        <script type="module">
            import * as d3 from "https://cdn.jsdelivr.net/npm/d3@7/+esm";

            fetch("https://raw.githubusercontent.com/freeCodeCamp/ProjectReferenceData/master/global-temperature.json")
                .then(response => response.json())
                .then(data => {
                    const json = data;
                    const arr = json.monthlyVariance
                    console.log(json, arr)

                    const margin = {
                        top: 90, 
                        right: 0, 
                        bottom: 0, 
                        left: 60
                    }
                    const w = 900 - margin.left - margin.right;
                    const h = 500 - margin.top - margin.bottom;
                    const rectH = h/12;
                    const rectW = w/(arr.length/12);

                    const xScale = d3.scaleLinear()
                        .domain([d3.min(arr, (d)=>d.year), d3.max(arr, (d)=>d.year)])
                        .range([margin.left, (margin.left+w)]);
                    const yScale = d3.scaleLinear()
                        .domain([d3.min(arr, (d)=>d.month), d3.max(arr, (d)=>d.month)])
                        .range([margin.top + h, margin.top])
                    const svg = d3.select("body")
                        .append("svg")
                        .attr("width", w+margin.left+margin.right)
                        .attr("height", h+margin.top+margin.bottom)
                        .attr("x", 25)
                        .attr("y", 35);
                    svg.selectAll("rect")
                        .data(arr)
                        .enter()
                        .append("rect")
                        .attr("x", (d)=>xScale(d.year))
                        .attr("y", (d)=>yScale(d.month))
                        .attr("width", rectW)
                        .attr("height", rectH)
                        .style("fill", "red")
                });

                const xAxisGenerator = d3.axisBottom(xScale);
                const yAxisGenerator = d3.axisLeft(yScale);

                const xAxis = svg.append("g")
                    .attr("transform", "translate(0," + (h-margin.bottom) + ")")
                    .attr("id", "x-axis")
                    .call(xAxisGenerator);
                const yAxis = svg.append("g")
                    .attr("transform", "translate(" + margin.left + ",0)")
                    .attr("id", "y-axis")
                    .call(yAxisGenerator);
        </script>
        <script src="https://cdn.freecodecamp.org/testable-projects-fcc/v1/bundle.js"></script>
    </body>
</html>